{"version":3,"sources":["file:///C:/Users/dekel/App/assets/Scripts/game.ts"],"names":["_decorator","Component","Node","UITransform","director","Label","getArrayOf5RandomLocations","ccclass","game","speed","maxScore","currentScore","isEventAdded","gameSpeed","lifeCounter","missed","isGameOver","startLocations","onLoad","node","parent","getChildByName","active","children","forEach","item","index","setPosition","on","EventType","MOUSE_DOWN","startGame","update","deltaTime","length","addListeners","birdWidthArr","randomNumbers","i","randomNumber","Math","floor","random","push","randomY","getComponent","width","position","y","gameOver","moveUp","increaseSpeed","showResult","pause","resume","string","console","log","max","result"],"mappings":";;;;;;;;;;;;;;;;AACEA,MAAAA,U,OAAAA,U;AACAC,MAAAA,S,OAAAA,S;AACAC,MAAAA,I,OAAAA,I;AAEAC,MAAAA,W,OAAAA,W;AACAC,MAAAA,Q,OAAAA,Q;AACAC,MAAAA,K,OAAAA,K;;AAGOC,MAAAA,0B,iBAAAA,0B;;;;;;;;;OADH;AAAEC,QAAAA;AAAF,O,GAAcP,U;;sBAIPQ,I,WADZD,OAAO,CAAC,MAAD,C,2BAAR,MACaC,IADb,SAC0BP,SAD1B,CACoC;AAAA;AAAA;AAAA,eACzBQ,KADyB,GACT,GADS;AAAA,eAGlCC,QAHkC,GAGf,CAHe;AAAA,eAIlCC,YAJkC,GAIX,CAJW;AAAA,eAKlCC,YALkC,GAKV,KALU;AAAA,eAMlCC,SANkC,GAMd,KAAKJ,KANS;AAAA,eAOlCK,WAPkC,GAOZ,CAPY;AAAA,eAQlCC,MARkC,GAQhB,KARgB;AAAA,eASlCC,UATkC,GASZ,KATY;AAAA,eAW3BC,cAX2B,GAWV,CAAC,GAAG;AAAA;AAAA,yEAAJ,CAXU;AAAA;;AAelCC,QAAAA,MAAM,GAAG;AACP,eAAKC,IAAL,CAAUC,MAAV,CAAiBA,MAAjB,CAAwBC,cAAxB,CAAuC,SAAvC,EAAkDC,MAAlD,GAA2D,IAA3D;AACA,eAAKH,IAAL,CAAUI,QAAV,CAAmBC,OAAnB,CAA2B,CAACC,IAAD,EAAOC,KAAP,KAAiB;AAC1CD,YAAAA,IAAI,CAACE,WAAL,CAAiB,KAAKV,cAAL,CAAoBS,KAApB,CAAjB;AACD,WAFD;AAIA,eAAKP,IAAL,CAAUC,MAAV,CAAiBA,MAAjB,CACGC,cADH,CACkB,OADlB,EAEGO,EAFH,CAEM1B,IAAI,CAAC2B,SAAL,CAAeC,UAFrB,EAEiC,MAAM;AACnC,iBAAKC,SAAL;AACD,WAJH;AAKD;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACxB,cAAI,CAAC,KAAKjB,UAAV,EAAsB;AACpB;AACA,gBAAI,CAAC,KAAKJ,YAAN,IAAsB,KAAKO,IAAL,CAAUI,QAAV,CAAmBW,MAAnB,GAA4B,CAAtD,EAAyD;AACvD,mBAAKC,YAAL;AACA,mBAAKvB,YAAL,GAAoB,IAApB;AACD;;AACD,gBAAMwB,YAAY,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAArB;AAEA,gBAAMC,aAAa,GAAG,EAAtB;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AAC1B,kBAAMC,YAAY,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiB,MAAM,GAAN,GAAY,CAA7B,CAAX,IAA8C,GAAnE;AACAL,cAAAA,aAAa,CAACM,IAAd,CAAmBJ,YAAnB;AACD;;AACD,gBAAMK,OAAO,GAAG,CAAC,GAAGP,aAAJ,CAAhB;AACA,iBAAKlB,IAAL,CAAUI,QAAV,CAAmBC,OAAnB,CAA2B,CAACC,IAAD,EAAOC,KAAP,KAAiB;AAC1CU,cAAAA,YAAY,CAACV,KAAD,CAAZ,GAAsBD,IAAI,CAACoB,YAAL,CAAkB1C,WAAlB,EAA+B2C,KAArD;AACA,mBAAK7B,cAAL,CAAoB0B,IAApB,CAAyB,KAAKxB,IAAL,CAAUI,QAAV,CAAmBG,KAAnB,EAA0BqB,QAAnD;AACA,mBAAK9B,cAAL,CAAoBS,KAApB,EAA2BsB,CAA3B,IAAgC,KAAKnC,SAAL,GAAiBoB,SAAjD;AACAR,cAAAA,IAAI,CAACE,WAAL,CAAiB,KAAKV,cAAL,CAAoBS,KAApB,CAAjB;;AACA,kBAAI,KAAKT,cAAL,CAAoBS,KAApB,EAA2BsB,CAA3B,IAAgC,IAAIZ,YAAY,CAACV,KAAD,CAApD,EAA6D;AAC3D,qBAAKT,cAAL,CAAoBS,KAApB,EAA2BsB,CAA3B,GAA+BJ,OAAO,CAAClB,KAAD,CAAtC;AACA,oBAAIA,KAAK,IAAI,CAAb,EAAgB,KAAKZ,WAAL;AACjB;;AACDW,cAAAA,IAAI,CAACE,WAAL,CAAiB,KAAKV,cAAL,CAAoBS,KAApB,CAAjB;AACD,aAVD;AAWA,iBAAKP,IAAL,CAAUC,MAAV,CACGC,cADH,CACkB,OADlB,EAEGE,QAFH,CAEYC,OAFZ,CAEoB,CAACC,IAAD,EAAOC,KAAP,KAAiB;AACjC,kBAAIA,KAAK,GAAG,KAAKZ,WAAjB,EAA8B;AAC5BW,gBAAAA,IAAI,CAACH,MAAL,GAAc,KAAd;AACD;;AACD,kBAAI,KAAKR,WAAL,GAAmB,CAAnB,IAAwB,CAAC,KAAKE,UAAlC,EAA8C;AAC5C,qBAAKA,UAAL,GAAkB,IAAlB;AACA,qBAAKiC,QAAL;AACD;AACF,aAVH;;AAWA,gBACE,KAAK9B,IAAL,CAAUC,MAAV,CAAiBA,MAAjB,CACGC,cADH,CACkB,OADlB,EAEGwB,YAFH,CAEgB,UAFhB,EAE4B,iBAF5B,CADF,EAIE;AACA,mBAAKd,SAAL;AACA,mBAAKZ,IAAL,CAAUC,MAAV,CAAiBA,MAAjB,CACGC,cADH,CACkB,OADlB,EAEGwB,YAFH,CAEgB,UAFhB,EAE4B,iBAF5B,IAEiD,KAFjD;AAGD;AACF;AACF;;AAEDV,QAAAA,YAAY,GAAG;AACb3B,UAAAA,IAAI,CAAC0C,MAAL,GAAexB,KAAD,IAAmB;AAC/B,gBAAMW,aAAa,GAAG,EAAtB;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AAC1B,kBAAMC,YAAY,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiB,MAAM,GAAN,GAAY,CAA7B,CAAX,IAA8C,GAAnE;AACAL,cAAAA,aAAa,CAACM,IAAd,CAAmBJ,YAAnB;AACD;;AACD,gBAAMK,OAAO,GAAG,CAAC,GAAGP,aAAJ,CAAhB;AACA,iBAAKpB,cAAL,CAAoBS,KAApB,EAA2BsB,CAA3B,GAA+BJ,OAAO,CAAClB,KAAD,CAAtC;AACD,WARD;;AASA,cAAMyB,aAAa,GAAG,MAAM;AAC1B,iBAAKtC,SAAL,IAAkB,EAAlB;AACD,WAFD;;AAIA,eAAKM,IAAL,CAAUI,QAAV,CAAmBC,OAAnB,CAA2B,CAACC,IAAD,EAAOC,KAAP,KAAiB;AAC1C,gBAAIA,KAAK,IAAI,CAAb,EAAgB;AACdD,cAAAA,IAAI,CAACG,EAAL,CAAQ1B,IAAI,CAAC2B,SAAL,CAAeC,UAAvB,EAAmC,MAAM;AACvCtB,gBAAAA,IAAI,CAAC0C,MAAL,CAAYxB,KAAZ;AACAyB,gBAAAA,aAAa;AACb,qBAAKrC,WAAL;AACD,eAJD;AAKD,aAND,MAMO;AACLW,cAAAA,IAAI,CAACG,EAAL,CAAQ1B,IAAI,CAAC2B,SAAL,CAAeC,UAAvB,EAAmC,MAAM;AACvCtB,gBAAAA,IAAI,CAAC0C,MAAL,CAAYxB,KAAZ;AACAyB,gBAAAA,aAAa;AACb,qBAAKxC,YAAL;AACD,eAJD;AAKD;AACF,WAdD;AAeD;;AAEDsC,QAAAA,QAAQ,GAAG;AACT,eAAKG,UAAL;AACAhD,UAAAA,QAAQ,CAACiD,KAAT;AACA,eAAKlC,IAAL,CAAUI,QAAV,CAAmBC,OAAnB,CAA4BC,IAAD,IAAU;AACnCA,YAAAA,IAAI,CAACH,MAAL,GAAc,KAAd;AACA,iBAAKH,IAAL,CAAUC,MAAV,CAAiBA,MAAjB,CAAwBC,cAAxB,CAAuC,OAAvC,EAAgDC,MAAhD,GAAyD,IAAzD;AACD,WAHD;AAID;;AAEDS,QAAAA,SAAS,GAAG;AACV,eAAKf,UAAL,GAAkB,KAAlB;AACA,eAAKG,IAAL,CAAUC,MAAV,CAAiBC,cAAjB,CAAgC,OAAhC,EAAyCE,QAAzC,CAAkDC,OAAlD,CAA2DC,IAAD,IAAU;AAClEA,YAAAA,IAAI,CAACH,MAAL,GAAc,IAAd;AACD,WAFD;AAGA,eAAKR,WAAL,GAAmB,CAAnB;AACA,eAAKD,SAAL,GAAiB,KAAKJ,KAAtB;AACA,eAAKE,YAAL,GAAoB,CAApB;AACAP,UAAAA,QAAQ,CAACkD,MAAT;AACA,eAAKnC,IAAL,CAAUI,QAAV,CAAmBC,OAAnB,CAA2B,CAACC,IAAD,EAAOC,KAAP,KAAiB;AAC1CD,YAAAA,IAAI,CAACH,MAAL,GAAc,IAAd;AACAd,YAAAA,IAAI,CAAC0C,MAAL,CAAYxB,KAAZ;AACD,WAHD;AAIA,eAAKP,IAAL,CAAUC,MAAV,CAAiBA,MAAjB,CACGC,cADH,CACkB,QADlB,EAEGwB,YAFH,CAEgBxC,KAFhB,EAEuBkD,MAFvB,GAEgC,UAFhC;AAGA,eAAKpC,IAAL,CAAUC,MAAV,CAAiBA,MAAjB,CAAwBC,cAAxB,CAAuC,QAAvC,EAAiDC,MAAjD,GAA0D,KAA1D;AACA,eAAKH,IAAL,CAAUC,MAAV,CAAiBA,MAAjB,CAAwBC,cAAxB,CAAuC,OAAvC,EAAgDC,MAAhD,GAAyD,KAAzD;AACAkC,UAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;AACD;;AAEDL,QAAAA,UAAU,GAAG;AACXI,UAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACA,eAAK/C,QAAL,GAAgB8B,IAAI,CAACkB,GAAL,CAAS,KAAKhD,QAAd,EAAwB,KAAKC,YAA7B,CAAhB;AACA,cAAMgD,MAAM,GAAG,KAAKxC,IAAL,CAAUC,MAAV,CAAiBA,MAAjB,CAAwBC,cAAxB,CAAuC,QAAvC,CAAf;AACAsC,UAAAA,MAAM,CAACd,YAAP,CAAoBxC,KAApB,EAA2BkD,MAA3B,IACE,cAAc,KAAK5C,YAAnB,GAAkC,gBAAlC,GAAqD,KAAKD,QAD5D;AAEAiD,UAAAA,MAAM,CAACrC,MAAP,GAAgB,IAAhB;AACD;;AAlJiC,O,UAa3B4B,M","sourcesContent":["import {\r\n  _decorator,\r\n  Component,\r\n  Node,\r\n  Vec3,\r\n  UITransform,\r\n  director,\r\n  Label,\r\n} from \"cc\";\r\nconst { ccclass } = _decorator;\r\nimport { getArrayOf5RandomLocations } from \"./main\";\r\n\r\n@ccclass(\"game\")\r\nexport class game extends Component {\r\n  readonly speed: number = 150;\r\n\r\n  maxScore: number = 0;\r\n  currentScore: number = 0;\r\n  isEventAdded: boolean = false;\r\n  gameSpeed: number = this.speed;\r\n  lifeCounter: number = 3;\r\n  missed: boolean = false;\r\n  isGameOver: boolean = false;\r\n\r\n  public startLocations = [...getArrayOf5RandomLocations()];\r\n\r\n  static moveUp: any;\r\n\r\n  onLoad() {\r\n    this.node.parent.parent.getChildByName(\"blue_bg\").active = true;\r\n    this.node.children.forEach((item, index) => {\r\n      item.setPosition(this.startLocations[index]);\r\n    });\r\n\r\n    this.node.parent.parent\r\n      .getChildByName(\"retry\")\r\n      .on(Node.EventType.MOUSE_DOWN, () => {\r\n        this.startGame();\r\n      });\r\n  }\r\n\r\n  update(deltaTime: number) {\r\n    if (!this.isGameOver) {\r\n      // console.log(\"game is running\");\r\n      if (!this.isEventAdded && this.node.children.length > 4) {\r\n        this.addListeners();\r\n        this.isEventAdded = true;\r\n      }\r\n      const birdWidthArr = [0, 0, 0, 0, 0];\r\n\r\n      const randomNumbers = [];\r\n      for (let i = 0; i < 5; i++) {\r\n        const randomNumber = Math.floor(Math.random() * (750 - 500 + 1)) + 500;\r\n        randomNumbers.push(randomNumber);\r\n      }\r\n      const randomY = [...randomNumbers];\r\n      this.node.children.forEach((item, index) => {\r\n        birdWidthArr[index] = item.getComponent(UITransform).width;\r\n        this.startLocations.push(this.node.children[index].position);\r\n        this.startLocations[index].y -= this.gameSpeed * deltaTime;\r\n        item.setPosition(this.startLocations[index]);\r\n        if (this.startLocations[index].y <= 0 - birdWidthArr[index]) {\r\n          this.startLocations[index].y = randomY[index];\r\n          if (index != 4) this.lifeCounter--;\r\n        }\r\n        item.setPosition(this.startLocations[index]);\r\n      });\r\n      this.node.parent\r\n        .getChildByName(\"lives\")\r\n        .children.forEach((item, index) => {\r\n          if (index > this.lifeCounter) {\r\n            item.active = false;\r\n          }\r\n          if (this.lifeCounter < 0 && !this.isGameOver) {\r\n            this.isGameOver = true;\r\n            this.gameOver();\r\n          }\r\n        });\r\n      if (\r\n        this.node.parent.parent\r\n          .getChildByName(\"retry\")\r\n          .getComponent(\"retryBtn\")[\"retryBtnClicked\"]\r\n      ) {\r\n        this.startGame();\r\n        this.node.parent.parent\r\n          .getChildByName(\"retry\")\r\n          .getComponent(\"retryBtn\")[\"retryBtnClicked\"] = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  addListeners() {\r\n    game.moveUp = (index: number) => {\r\n      const randomNumbers = [];\r\n      for (let i = 0; i < 5; i++) {\r\n        const randomNumber = Math.floor(Math.random() * (750 - 250 + 1)) + 500;\r\n        randomNumbers.push(randomNumber);\r\n      }\r\n      const randomY = [...randomNumbers];\r\n      this.startLocations[index].y = randomY[index];\r\n    };\r\n    const increaseSpeed = () => {\r\n      this.gameSpeed += 10;\r\n    };\r\n\r\n    this.node.children.forEach((item, index) => {\r\n      if (index == 4) {\r\n        item.on(Node.EventType.MOUSE_DOWN, () => {\r\n          game.moveUp(index);\r\n          increaseSpeed();\r\n          this.lifeCounter--;\r\n        });\r\n      } else {\r\n        item.on(Node.EventType.MOUSE_DOWN, () => {\r\n          game.moveUp(index);\r\n          increaseSpeed();\r\n          this.currentScore++;\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  gameOver() {\r\n    this.showResult();\r\n    director.pause();\r\n    this.node.children.forEach((item) => {\r\n      item.active = false;\r\n      this.node.parent.parent.getChildByName(\"retry\").active = true;\r\n    });\r\n  }\r\n\r\n  startGame() {\r\n    this.isGameOver = false;\r\n    this.node.parent.getChildByName(\"lives\").children.forEach((item) => {\r\n      item.active = true;\r\n    });\r\n    this.lifeCounter = 3;\r\n    this.gameSpeed = this.speed;\r\n    this.currentScore = 0;\r\n    director.resume();\r\n    this.node.children.forEach((item, index) => {\r\n      item.active = true;\r\n      game.moveUp(index);\r\n    });\r\n    this.node.parent.parent\r\n      .getChildByName(\"result\")\r\n      .getComponent(Label).string = \"Result: \";\r\n    this.node.parent.parent.getChildByName(\"result\").active = false;\r\n    this.node.parent.parent.getChildByName(\"retry\").active = false;\r\n    console.log(\"game started\");\r\n  }\r\n\r\n  showResult() {\r\n    console.log(\"show result\");\r\n    this.maxScore = Math.max(this.maxScore, this.currentScore);\r\n    const result = this.node.parent.parent.getChildByName(\"result\");\r\n    result.getComponent(Label).string +=\r\n      \"\\nScore: \" + this.currentScore + \"\\nHigh Score: \" + this.maxScore;\r\n    result.active = true;\r\n  }\r\n}\r\n"]}